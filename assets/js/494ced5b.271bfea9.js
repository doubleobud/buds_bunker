"use strict";(self.webpackChunkbunker=self.webpackChunkbunker||[]).push([[7875],{3198:(e,r,t)=>{t.d(r,{C1:()=>a,wA:()=>s});const a="/buds_bunker",s=`https://doubleobud.github.io${a}`},4530:(e,r,t)=>{t.d(r,{A:()=>i});var a=t(6540),s=t(1410),n=t(4848);function i(e){return(0,a.useLayoutEffect)((()=>{document.documentElement.setAttribute("data-navbar","false")}),[]),(0,n.jsx)(s.A,{...e,children:e.children})}},4610:(e,r,t)=>{t.d(r,{CE:()=>n,gi:()=>i,t9:()=>o});var a=t(5286);const s={version:"v1",level:1,health:100,stamina:50,keywords:[],tutorial_complete:!1,codex_unlocked:!1,faction_board_unlocked:!1};async function n(){const{data:{session:e}}=await a.N.auth.getSession(),r=e?.user;if(!r)throw new Error("Not authenticated");const{data:t,error:n}=await a.N.from("characters").select().eq("user_id",r.id).maybeSingle();if(n)throw console.error("[character] Fetch error:",n.message),n;if(t)return t;const i=String(Math.floor(1e5+9e5*Math.random())),{data:o,error:c}=await a.N.from("characters").insert({user_id:r.id,user_id_number:i,stats:s}).select().single();if(c)throw console.error("[character] Insert error:",c.message),c;return o}async function i(){const{data:{session:e}}=await a.N.auth.getSession(),r=e?.user;if(!r)throw new Error("Not authenticated");const{data:t,error:s}=await a.N.from("characters").select().eq("user_id",r.id).maybeSingle();if(s)throw console.error("[character] Get error:",s.message),s;return t}async function o(e){const{data:{session:r}}=await a.N.auth.getSession(),t=r?.user;if(!t)throw new Error("Not authenticated");const{data:s,error:n}=await a.N.from("characters").update(e).eq("user_id",t.id).select().single();if(n)throw n;return{data:s,error:n}}},8683:(e,r,t)=>{t.r(r),t.d(r,{default:()=>d});var a=t(6540),s=t(4530),n=t(6347),i=t(5286),o=t(3198);var c=t(4610),u=t(4848);function l(){const e=(0,n.W6)(),[r,t]=(0,a.useState)(""),[s,l]=(0,a.useState)(""),[d,h]=(0,a.useState)(null),[g,m]=(0,a.useState)("");return(0,u.jsxs)("div",{style:{padding:"1rem",border:"1px solid #ccc",borderRadius:"6px"},children:[(0,u.jsx)("h2",{children:"\ud83d\udd11 Sign Up / Sign In"}),!d&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("input",{type:"email",placeholder:"Email",value:r,onChange:e=>t(e.target.value),style:{display:"block",marginBottom:"0.5rem"}}),(0,u.jsx)("input",{type:"password",placeholder:"Password",value:s,onChange:e=>l(e.target.value),style:{display:"block",marginBottom:"0.5rem"}}),(0,u.jsx)("button",{onClick:async()=>{try{await async function(e,r){const{data:t,error:a}=await i.N.auth.signUp({email:e,password:r,options:{emailRedirectTo:`${o.wA}/profile`}});if(a)throw a;return t}(r,s),m("\u2705 Sign-up successful! Please check your email to confirm.")}catch(e){console.error(e),m(`\u274c Sign-up failed: ${e.message}`)}},children:"Create Account"}),(0,u.jsx)("button",{onClick:async()=>{try{const{user:a}=await async function(e,r){const{data:t,error:a}=await i.N.auth.signInWithPassword({email:e,password:r});if(a)throw a;return t}(r,s);if(!a||!a.id)throw new Error("Missing or invalid user from Supabase");h(a),m("\ud83d\udd04 Signed in! Checking for character...");try{await(0,c.CE)(),m("\u2705 Character ready! Redirecting..."),setTimeout((()=>e.push(`${o.C1}/profile`)),3e3)}catch(t){console.error(t),m("\u274c Character creation failed. Please try again or contact support.")}}catch(a){console.error(a),m(`\u274c Sign-in failed: ${a.message}`)}},style:{marginLeft:"0.5rem"},children:"Sign In"})]}),d&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("p",{children:["\ud83d\udc64 Logged in as: ",d.email]}),(0,u.jsx)("button",{onClick:async()=>{try{await async function(){const{error:e}=await i.N.auth.signOut();if(e)throw e}(),h(null),m("\ud83d\udc4b Signed out.")}catch(e){console.error(e),m(`\u274c Sign-out failed: ${e.message}`)}},children:"Sign Out"})]}),g&&(0,u.jsx)("p",{style:{marginTop:"1rem"},children:g})]})}function d(){return(0,u.jsx)(s.A,{title:"Auth Test",description:"Sign up or log in to access the simulation.",children:(0,u.jsxs)("main",{style:{padding:"2rem"},children:[(0,u.jsx)("h1",{children:"\ud83d\udd10 Auth Test Page"}),(0,u.jsx)("p",{children:"This is a test page for signing up and managing user sessions."}),(0,u.jsx)("div",{style:{marginTop:"2rem"},children:(0,u.jsx)(l,{})})]})})}}}]);