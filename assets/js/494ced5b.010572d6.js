"use strict";(self.webpackChunkbunker=self.webpackChunkbunker||[]).push([[7875],{3198:(e,r,t)=>{t.d(r,{C1:()=>a,kg:()=>s});const a="/buds_bunker",s=`https://doubleobud.github.io${a}`},4530:(e,r,t)=>{t.d(r,{A:()=>i});var a=t(6540),s=t(1410),n=t(4848);function i(e){return(0,a.useLayoutEffect)((()=>{document.documentElement.setAttribute("data-navbar","false")}),[]),(0,n.jsx)(s.A,{...e,children:e.children})}},4610:(e,r,t)=>{t.d(r,{CE:()=>n,gi:()=>i,t9:()=>o});var a=t(5286);const s={version:"v1",level:1,health:100,stamina:50,keywords:[],tutorial_complete:!1,codex_unlocked:!1,faction_board_unlocked:!1};async function n(){const{data:{session:e}}=await a.N.auth.getSession(),r=e?.user;if(!r)throw new Error("Not authenticated");const{data:t,error:n}=await a.N.from("characters").select().eq("user_id",r.id).maybeSingle();if(n)throw console.error("[character] Fetch error:",n.message),n;if(t)return t;const i=String(Math.floor(1e5+9e5*Math.random())),{data:o,error:c}=await a.N.from("characters").insert({user_id:r.id,user_id_number:i,stats:s}).select().single();if(c)throw console.error("[character] Insert error:",c.message),c;return o}async function i(){const{data:{session:e}}=await a.N.auth.getSession(),r=e?.user;if(!r)throw new Error("Not authenticated");const{data:t,error:s}=await a.N.from("characters").select().eq("user_id",r.id).maybeSingle();if(s)throw console.error("[character] Get error:",s.message),s;return t}async function o(e){const{data:{session:r}}=await a.N.auth.getSession(),t=r?.user;if(!t)throw new Error("Not authenticated");const{data:s,error:n}=await a.N.from("characters").update(e).eq("user_id",t.id).select().single();if(n)throw n;return{data:s,error:n}}},8683:(e,r,t)=>{t.r(r),t.d(r,{default:()=>g});var a={};t.r(a),t.d(a,{H:()=>l});var s=t(6540),n=t(4530),i=t(6347),o=t(5286),c=t(3198);async function l(e,r){const{data:t,error:a}=await o.N.auth.signUp({email:e,password:r,options:{emailRedirectTo:`${c.kg}/email-confirm`}});if(a)throw a;return t}var u=t(4610),d=t(4848);function h(){const e=(0,i.W6)(),[r,t]=(0,s.useState)(""),[n,o]=(0,s.useState)(""),[h,g]=(0,s.useState)(null),[m,f]=(0,s.useState)("");return(0,d.jsxs)("div",{style:{padding:"1rem",border:"1px solid #ccc",borderRadius:"6px"},children:[(0,d.jsx)("h2",{children:"\ud83d\udd11 Sign Up / Sign In"}),!h&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("input",{type:"email",placeholder:"Email",value:r,onChange:e=>t(e.target.value),style:{display:"block",marginBottom:"0.5rem"}}),(0,d.jsx)("input",{type:"password",placeholder:"Password",value:n,onChange:e=>o(e.target.value),style:{display:"block",marginBottom:"0.5rem"}}),(0,d.jsx)("button",{onClick:async()=>{try{await l(r,n),f("\u2705 Sign-up successful! Please check your email to confirm.")}catch(e){console.error(e),f(`\u274c Sign-up failed: ${e.message}`)}},children:"Create Account"}),(0,d.jsx)("button",{onClick:async()=>{try{const{user:s}=await(0,a.signIn)(r,n);if(!s||!s.id)throw new Error("Missing or invalid user from Supabase");g(s),f("\ud83d\udd04 Signed in! Checking for character...");try{await(0,u.CE)(),f("\u2705 Character ready! Redirecting..."),setTimeout((()=>e.push(`${c.C1}/profile`)),3e3)}catch(t){console.error(t),f("\u274c Character creation failed. Please try again or contact support.")}}catch(s){console.error(s),f(`\u274c Sign-in failed: ${s.message}`)}},style:{marginLeft:"0.5rem"},children:"Sign In"})]}),h&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("p",{children:["\ud83d\udc64 Logged in as: ",h.email]}),(0,d.jsx)("button",{onClick:async()=>{try{await(0,a.signOut)(),g(null),f("\ud83d\udc4b Signed out.")}catch(e){console.error(e),f(`\u274c Sign-out failed: ${e.message}`)}},children:"Sign Out"})]}),m&&(0,d.jsx)("p",{style:{marginTop:"1rem"},children:m})]})}function g(){return(0,d.jsx)(n.A,{title:"Auth Test",description:"Sign up or log in to access the simulation.",children:(0,d.jsxs)("main",{style:{padding:"2rem"},children:[(0,d.jsx)("h1",{children:"\ud83d\udd10 Auth Test Page"}),(0,d.jsx)("p",{children:"This is a test page for signing up and managing user sessions."}),(0,d.jsx)("div",{style:{marginTop:"2rem"},children:(0,d.jsx)(h,{})})]})})}}}]);